---
import shiki from 'shiki';
import tree from 'tree-node-cli';
import { existsSync } from 'node:fs';
import { resolve } from 'node:path';

export interface Props {
  src?: string;
  content?: string;
}

const { src, content } = Astro.props;

const highlighterLight = await shiki.getHighlighter({ theme: 'github-light' });

const highlighterDark = await shiki.getHighlighter({ theme: 'github-dark' });

const codeTree = existsSync(resolve('./public' + src))
  ? tree(resolve('./public' + src))
  : 'Code not found';

const codeMarkdownLight = highlighterLight.codeToHtml(content ?? codeTree, {
  lang: 'plaintext',
});

const codeMarkdownDark = highlighterDark.codeToHtml(content ?? codeTree, {
  lang: 'plaintext',
});
---

<Fragment set:html={codeMarkdownLight} />

<Fragment set:html={codeMarkdownDark} />
