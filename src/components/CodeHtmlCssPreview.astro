---
import { existsFile } from '../helpers/files';
import CodePreview from './CodePreview.astro';
import CodeTree from './CodeTree.astro';
import HtmlPreview from './HtmlPreview.astro';

export interface Props {
  src: string;
  onlyBody?: boolean;
  codeTree?: boolean;
  isShowHtml?: boolean;
  isShowCss?: boolean;
  isShowIframe?: boolean;
  height?: number;
  htmlFile: string;
}

const {
  src,
  height,
  onlyBody = true,
  isShowIframe = true,
  isShowHtml = true,
  isShowCss = true,
  codeTree = false,
  htmlFile,
} = Astro.props;

const codeName = src.split('/').pop();

const htmlPath = `${src}/${htmlFile ?? 'index.html'}`;

const cssPath = `${src}/css/style.css`;
---

<p>
  <a href={`/lm${htmlPath}`}>{codeName}</a>:
</p>

<HtmlPreview src={htmlPath} height={height} isShowIframe={isShowIframe} />

{
  codeTree && (
    <>
      <p>Arquivos:</p>
      <CodeTree src={src} />
    </>
  )
}

{
  isShowHtml && (
    <>
      <p>
        <code>{htmlPath}</code>:
      </p>

      <CodePreview src={htmlPath} onlyBody={onlyBody} />
    </>
  )
}

{
  existsFile(cssPath) && isShowCss && (
    <>
      <p>
        <code>{cssPath}</code>:
      </p>

      <CodePreview src={cssPath} />
    </>
  )
}
